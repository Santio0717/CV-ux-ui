document.addEventListener("DOMContentLoaded", () => {
  const content = document.getElementById("case-content");
  const tabs = Array.from(document.querySelectorAll(".ux-tab[data-page]"));

  if (!content || !tabs.length) return;

  // Base URL real del folder donde está index.html
  const base = new URL("./", window.location.href);

  function setActiveTab(activeBtn) {
    tabs.forEach(btn => {
      const isActive = btn === activeBtn;
      btn.classList.toggle("active", isActive);
      btn.setAttribute("aria-selected", isActive ? "true" : "false");
    });
  }

  function showError(msg = "No se pudo cargar el contenido.") {
    content.innerHTML = `
      <div style="text-align:center; padding:18px; border-radius:12px; background:rgba(255,255,255,.45);">
        <strong>${msg}</strong>
      </div>
    `;
  }

  async function loadPage(page) {
    try {
      const url = new URL(page, base);
      const res = await fetch(url.toString(), { cache: "no-store" });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const html = await res.text();
      content.innerHTML = html;
    } catch (err) {
      console.error(err);
      showError();
    }
  }

  function activate(btn) {
    setActiveTab(btn);
    loadPage(btn.dataset.page);
  }

  // Click en tabs
  tabs.forEach(btn => {
    btn.addEventListener("click", (e) => {
      e.preventDefault();
      activate(btn);
    });
  });

  // Inicial: botón activo o el primero
  const initial =
    tabs.find(b => b.classList.contains("active")) || tabs[0];

  activate(initial);
});
