document.addEventListener("DOMContentLoaded", () => {
  const content = document.getElementById("case-content");
  const tabs = document.querySelectorAll(".ux-tab");

  function setActiveTab(activeBtn){
    tabs.forEach(btn => {
      const isActive = btn === activeBtn;
      btn.classList.toggle("active", isActive);
      btn.setAttribute("aria-selected", isActive ? "true" : "false");
    });
  }

  async function loadPage(page){
    try{
      const res = await fetch(page, { cache: "no-store" });
      if(!res.ok) throw new Error("No se pudo cargar: " + page);
      const html = await res.text();
      content.innerHTML = html;
    }catch(err){
      content.innerHTML = `<p style="text-align:center;">Error cargando el contenido.</p>`;
      console.error(err);
    }
  }

  // Carga inicial (primera tab)
  const first = document.querySelector(".ux-tab.active") || tabs[0];
  if(first){
    setActiveTab(first);
    loadPage(first.dataset.page);
  }

  tabs.forEach(btn => {
    btn.addEventListener("click", () => {
      setActiveTab(btn);
      loadPage(btn.dataset.page);
    });
  });
});
